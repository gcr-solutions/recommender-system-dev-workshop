<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.79.1"><meta name=description content><link rel="shortcut icon" href=https://gcr-solutions.github.io/recommender-system-dev-workshop/images/favicon.ico type=image/x-icon><title>Switch Recommendation Method :: Recommender System Solution</title><link href=https://gcr-solutions.github.io/recommender-system-dev-workshop/css/nucleus.css?1650786079 rel=stylesheet><link href=https://gcr-solutions.github.io/recommender-system-dev-workshop/css/fontawesome-all.min.css?1650786079 rel=stylesheet><link href=https://gcr-solutions.github.io/recommender-system-dev-workshop/css/hybrid.css?1650786079 rel=stylesheet><link href=https://gcr-solutions.github.io/recommender-system-dev-workshop/css/featherlight.min.css?1650786079 rel=stylesheet><link href=https://gcr-solutions.github.io/recommender-system-dev-workshop/css/perfect-scrollbar.min.css?1650786079 rel=stylesheet><link href=https://gcr-solutions.github.io/recommender-system-dev-workshop/css/auto-complete.css?1650786079 rel=stylesheet><link href=https://gcr-solutions.github.io/recommender-system-dev-workshop/css/atom-one-dark-reasonable.css?1650786079 rel=stylesheet><link href=https://gcr-solutions.github.io/recommender-system-dev-workshop/css/theme.css?1650786079 rel=stylesheet><link href=https://gcr-solutions.github.io/recommender-system-dev-workshop/css/tabs.css?1650786079 rel=stylesheet><link href=https://gcr-solutions.github.io/recommender-system-dev-workshop/css/hugo-theme.css?1650786079 rel=stylesheet><script src=https://gcr-solutions.github.io/recommender-system-dev-workshop/js/jquery-3.3.1.min.js?1650786079></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=https://gcr-solutions.github.io/recommender-system-dev-workshop/develop-experience/8_change_method/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=https://gcr-solutions.github.io/recommender-system-dev-workshop/><img src=https://gcr-solutions.github.io/recommender-system-dev-workshop/images/logo.png alt="AWS Logo" width=44% height=44%></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=https://gcr-solutions.github.io/recommender-system-dev-workshop/js/lunr.min.js?1650786079></script><script type=text/javascript src=https://gcr-solutions.github.io/recommender-system-dev-workshop/js/auto-complete.js?1650786079></script><script type=text/javascript>var baseurl="https:\/\/gcr-solutions.github.io\/recommender-system-dev-workshop\/";</script><script type=text/javascript src=https://gcr-solutions.github.io/recommender-system-dev-workshop/js/search.js?1650786079></script></div><div class=highlightable><ul class=topics><li data-nav-id=/prerequisite/ title=Prerequisite class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/prerequisite/>Prerequisite</a><ul><li data-nav-id=/prerequisite/environment/ title=Environment class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/prerequisite/environment/>Environment</a></li><li data-nav-id=/prerequisite/workspace/ title="Setup Workspace" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/prerequisite/workspace/>Setup Workspace</a></li></ul></li><li data-nav-id=/deploy/ title=Deployment class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/deploy/>Deployment</a><ul><li data-nav-id=/deploy/scenario-method/ title="Choose Scenario and Method" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/deploy/scenario-method/>Choose Scenario and Method</a></li><li data-nav-id=/deploy/offline/ title="Deploy Offline" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/deploy/offline/>Deploy Offline</a></li><li data-nav-id=/deploy/online/ title="Deploy Online" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/deploy/online/>Deploy Online</a><ul><li data-nav-id=/deploy/online/create-online-ci/ title="Create Online CodeBuild" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/deploy/online/create-online-ci/>Create Online CodeBuild</a></li><li data-nav-id=/deploy/online/create-infra/ title="Create Infrastructure" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/deploy/online/create-infra/>Create Infrastructure</a></li><li data-nav-id=/deploy/online/update-online-config/ title="Update Config" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/deploy/online/update-online-config/>Update Config</a></li><li data-nav-id=/deploy/online/argocd-server/ title="Setup Argo CD Server" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/deploy/online/argocd-server/>Setup Argo CD Server</a></li><li data-nav-id=/deploy/online/create-argocd-app/ title="Create Argo CD application" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/deploy/online/create-argocd-app/>Create Argo CD application</a></li></ul></li></ul></li><li data-nav-id=/develop-experience/ title="How Does It Work" class="dd-item
parent"><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/develop-experience/>How Does It Work</a><ul><li data-nav-id=/develop-experience/1_overview/ title="The Story Line Of Recommender System Workshop" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/develop-experience/1_overview/>The Story Line Of Recommender System Workshop</a></li><li data-nav-id=/develop-experience/2_user/ title="Browse The Recommender System" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/develop-experience/2_user/>Browse The Recommender System</a></li><li data-nav-id=/develop-experience/3_data/ title="Data Exploration" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/develop-experience/3_data/>Data Exploration</a></li><li data-nav-id=/develop-experience/4_develop_online/readme/ title="Develop Online Of Recommender System" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/develop-experience/4_develop_online/readme/>Develop Online Of Recommender System</a></li><li data-nav-id=/develop-experience/5_develop_offline/readme/ title="Develop Offline Of Recommender System" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/develop-experience/5_develop_offline/readme/>Develop Offline Of Recommender System</a></li><li data-nav-id=/develop-experience/6_train/ title="Action Model Update" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/develop-experience/6_train/>Action Model Update</a></li><li data-nav-id=/develop-experience/7_new/ title="New Items Added And Batch Update" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/develop-experience/7_new/>New Items Added And Batch Update</a></li><li data-nav-id=/develop-experience/8_change_method/ title="Switch Recommendation Method" class="dd-item
parent
active"><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/develop-experience/8_change_method/>Switch Recommendation Method</a></li></ul></li><li data-nav-id=/cleanup/ title=Cleanup class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/cleanup/>Cleanup</a></li><li data-nav-id=/debug-tips/ title=Tips class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/debug-tips/>Tips</a><ul><li data-nav-id=/debug-tips/issues/ title=Debug class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/debug-tips/issues/>Debug</a><ul><li data-nav-id=/debug-tips/issues/deploy-argocd-application-issues/ title="Create Argo CD Application" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/debug-tips/issues/deploy-argocd-application-issues/>Create Argo CD Application</a></li><li data-nav-id=/debug-tips/issues/demo-web-issues/ title="Browse The Recommender System" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/debug-tips/issues/demo-web-issues/>Browse The Recommender System</a></li><li data-nav-id=/debug-tips/issues/codebuild-issues/ title="Deploy CodeBuild" class=dd-item><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/debug-tips/issues/codebuild-issues/>Deploy CodeBuild</a></li></ul></li></ul></li></ul><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value;">
<option id=en value=https://gcr-solutions.github.io/recommender-system-dev-workshop/develop-experience/8_change_method/ selected>English</option>
<option id=cn value=https://gcr-solutions.github.io/recommender-system-dev-workshop/cn/develop-experience/8_change_method/>Chinese</option></select><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li></ul></section><section id=footer><left><a class=github-button href=https://github.com/gcr-solutions/recommender-system-dev-workshop data-icon=octicon-cloud-download aria-label="Repo of gcr-solutions/recommender-system-dev-workshop on GitHub">Repo</a>
<a class=github-button href=https://github.com/gcr-solutions/recommender-system-dev-workshop data-icon=octicon-star data-show-count=false aria-label="Star gcr-solutions/recommender-system-dev-workshop on GitHub">Star</a>
<a class=github-button href=https://github.com/gcr-solutions/recommender-system-dev-workshop/fork data-icon=octicon-repo-forked data-show-count=false aria-label="Fork gcr-solutions/recommender-system-dev-workshop on GitHub">Fork</a><p><a href="https://aws.amazon.com/privacy/?nc1=f_pr">Privacy</a> | <a href="https://aws.amazon.com/terms/?nc1=f_pr">Site Terms</a> | © 2021, Amazon Web Services, Inc. or its affiliates. All rights reserved</p></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/>Recommender System Solution Workshop</a> > <a href=https://gcr-solutions.github.io/recommender-system-dev-workshop/develop-experience/>How Does It Work</a> > Switch Recommendation Method</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#how-to-switch-methodoptional>How to switch method（optional）</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Switch Recommendation Method</h1><p>Amazon Personalize is a fully managed personalized recommendation service that includes a variety of algorithms. These algorithms based on more than 20 years of personalization experience and development expertise in Amazon&rsquo;s retail business. The GCR Recommendation System provides three suggestions to use Amazon Personalize. You can switch to different mode with only one command, compare their recommendation results, and choose the most suitable recommendation system plan for your current business. The three plans shown in the following table:</p><table><thead><tr><th>Plan</th><th>Amazon Personalize Recipe</th><th>Description</th><th>Alias</th></tr></thead><tbody><tr><td>Complete Substitution</td><td>aws-user-personalization</td><td>If you only want to use the Amazon Personalize Service to achieve personalized recommendations for users, then you can adopt this plan. The online part of this plan provides actual use cases of Amazon Personalize Service, and the offline part provides automated processes of three functions: Model Update, New Item Addition, and New User Addition. This plan can greatly speed up your time to get started and deploy the Amazon Personalize Service.</td><td>ps-complete</td></tr><tr><td>Rank Model Substitution</td><td>aws-personalized-ranking</td><td>The existing ranking model of the GCR Recommendation System is the DKN model based on the knowledge graph. If you want to use the ranking model provided by Amazon Personalize, you can adopt this plan. The online part of this plan replaces the DKN model of the ranking module with the aws-personalized-ranking model. On the basis of the original process, the offline part adds the model training and data set import process of the Amazon Personalize service, and replaces the model with the aws-personalized-ranking model in the rank batch.</td><td>ps-rank</td></tr><tr><td>One Way Recall Logic</td><td>aws-sims</td><td>The existing recall model of the GCR Recommendation System contains four-way recall logic. If you want to use the item similarity model provided by Amazon Personalize as the fifth recall logic, you can adopt this plan. In the online part of this plan, one more recall logic provided by Amazon Personalize is added to the recall module. On the basis of the original process, the offline part adds the model training and data set import process of the Amazon Personalize service, and adds the recall logic implemented by aws-sims to the recall batch.</td><td>ps-sims</td></tr></tbody></table><p>If you want to switch to the <strong>Complete Substitution</strong>, execute the following command:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cd /home/ec2-user/environment/recommender-system-dev-workshop-code/scripts
./setup-rs-system.sh change-method ps-complete
</code></pre></div><p>If you have not deployed <strong>ps-complete</strong> related resources, the terminal will print the notification. Please run the following command:</p><p><img src=https://gcr-solutions.github.io/recommender-system-dev-workshop/images/ps-complete-not-exist.png alt="ps-complete not exist"></p><p>After execution, ArgoCD will deploy services in 3 minutes. Open the Argo CD website, you will see that containers are synchronizing and updating. If not, please click <strong>REFRESH</strong>. This process takes about 1 minute.</p><p><img src=https://gcr-solutions.github.io/recommender-system-dev-workshop/images/argocd-sync-method.png alt="Argo CD Sync"></p><p>After the synchronization is complete, open the Demo Website. At this time, the Recommendation System has been changed to retrieve the results entirely from the Amazon Personalize Service. Click the <strong>Recommendation</strong> button, and open the logs of the Retrieve Pod on the Argo CD website. You can see the newest recommendation list contains <strong>ps-complete</strong> description, which means that the Amazon Personalize Service provides the recommendation list.</p><p><img src=https://gcr-solutions.github.io/recommender-system-dev-workshop/images/ps-complete-result.png alt="ps complete log"></p><p>If you want to switch to the <strong>Rank Model Substitution</strong>, execute the following command:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cd /home/ec2-user/environment/recommender-system-dev-workshop-code/scripts
./setup-rs-system.sh change-method ps-rank
</code></pre></div><p>If you have not deployed <strong>ps-rank</strong> related resources, the terminal will print the notification. Please run the following command:</p><p><img src=https://gcr-solutions.github.io/recommender-system-dev-workshop/images/ps-rank-not-exist.png alt="ps-rank not exist"></p><p>After execution, open the Argo CD website and wait for the synchronization to complete.</p><p>Open the Demo Website, at this time the Recommendation System has been changed to use aws-personalized-ranking model rather than DKN model for ranking process. Click three news, and open the logs of the Rank Pod on the Argo CD website. You can see the ranking result contains the word <strong>ps-rank</strong>.</p><p><img src=https://gcr-solutions.github.io/recommender-system-dev-workshop/images/ps-rank-result.png alt="ps rank log"></p><p>If you want to switch to the <strong>One Way Recall Logic</strong>, execute the following command:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cd /home/ec2-user/environment/recommender-system-dev-workshop-code/scripts
./setup-rs-system.sh change-method ps-sims
</code></pre></div><p>If you have not deployed <strong>ps-sims</strong> related resources, the terminal will print the notification. Please run the following command:</p><p><img src=https://gcr-solutions.github.io/recommender-system-dev-workshop/images/ps-sims-not-exist.png alt="ps-sims not exist"></p><p>After execution, open the Argo CD website and wait for the synchronization to complete.</p><p>Open the Demo Website. At this time, the Recommendation system has added one more recall logic implemented by aws-sims to recall service. Click three news, and open the logs of the Recall Pod on the Argo CD website. You can see the recall result contains the word <strong>ps-sims</strong>.</p><p><img src=https://gcr-solutions.github.io/recommender-system-dev-workshop/images/ps-sims-result.png alt="ps sims log"></p><p>If you want to return to the <strong>customize</strong> method, just execute the following command and refresh the Argo CD:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cd /home/ec2-user/environment/recommender-system-dev-workshop-code/scripts
./setup-rs-system.sh change-method customize
</code></pre></div><h2 id=how-to-switch-methodoptional>How to switch method（optional）</h2><p>If you have interests in understanding more about the process behind switching method, you can check the following content.</p><p>After you execute <code>./setup-rs-system.sh change-method $METHOD</code>, you will see the following output in your terminal:</p><p><img src=https://gcr-solutions.github.io/recommender-system-dev-workshop/images/change-method-output.png alt="change method output"></p><p>The change-method.sh script has the following steps:</p><ol><li><p>Update the solution name and campaign name in the config file (ps_config.json) by the input variable <strong>METHOD</strong>.</p></li><li><p>Update the Latest Version ID in the config file (ps_config.json) from the Amazon Personalize Service.</p></li><li><p>Synchronize the new config file to the AWS S3 Service.</p></li><li><p>Notify the online loader service to download the latest config file from S3.</p></li><li><p>Update the METHOD variable in the EKS ConfigMap. Commit the change and push to the repository in the AWS CodeCommit Service.</p></li></ol><p>After execution, Argo CD will synchronize the service automatically. The process is as following:</p><p><img src=https://gcr-solutions.github.io/recommender-system-dev-workshop/images/change-method-process.png alt="change method process"></p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=https://gcr-solutions.github.io/recommender-system-dev-workshop/develop-experience/7_new/ title="New Items Added And Batch Update"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=https://gcr-solutions.github.io/recommender-system-dev-workshop/cleanup/ title=Cleanup style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=https://gcr-solutions.github.io/recommender-system-dev-workshop/js/clipboard.min.js?1650786079></script><script src=https://gcr-solutions.github.io/recommender-system-dev-workshop/js/perfect-scrollbar.min.js?1650786079></script><script src=https://gcr-solutions.github.io/recommender-system-dev-workshop/js/perfect-scrollbar.jquery.min.js?1650786079></script><script src=https://gcr-solutions.github.io/recommender-system-dev-workshop/js/jquery.sticky.js?1650786079></script><script src=https://gcr-solutions.github.io/recommender-system-dev-workshop/js/featherlight.min.js?1650786079></script><script src=https://gcr-solutions.github.io/recommender-system-dev-workshop/js/highlight.pack.js?1650786079></script><script>hljs.initHighlightingOnLoad();</script><script src=https://gcr-solutions.github.io/recommender-system-dev-workshop/js/modernizr.custom-3.6.0.js?1650786079></script><script src=https://gcr-solutions.github.io/recommender-system-dev-workshop/js/learn.js?1650786079></script><script src=https://gcr-solutions.github.io/recommender-system-dev-workshop/js/hugo-learn.js?1650786079></script><script src=https://gcr-solutions.github.io/recommender-system-dev-workshop/mermaid/mermaid.js?1650786079></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>